#==== Selfupdate Start ============== #
name="kextupdater"
lecho=`cat script |grep ScriptVersion | head -n1 | sed -e "s/.*\=//g"`
local=`echo $lecho | sed -e "s/\.//g"`
  if [[ $lan2 != "de_DE" ]]; then
  echo "Checking Kext Updater ..."
  else
  echo "Überprüfe Kext Updater ..."
  fi
remote=`cat /tmp/overview.html |grep kextupdater |sed -e "s/.*-//g" -e "s/+.*//g"`
recho=`cat /tmp/overview.html |grep kextupdater |sed "s/.*+//g"`

if [ -f ~/Desktop/Kext-Updates/$name/.version.htm ]; then
dupe=`cat ~/Desktop/Kext-Updates/$name/.version.htm`
    if [[ $dupe = $remote ]]; then
      if [[ $lan2 != "de_DE" ]]; then
      echo "The latest Version is already downloaded to your Desktop. If its already installed please remove the Folder from your Desktop."
      else
      echo "Die aktuellste Version befindet sich bereits auf dem Schreibtisch. Wenn sie bereits installiert ist, kannst Du den Ordner löschen."
      fi
    echo "-----------------------------------------------------------"
    fi
else
    if [[ $local < $remote ]]; then
    mkdir -p ~/Desktop/Kext-Updates ~/Desktop/Kext-Updates/
      if [[ $lan2 != "de_DE" ]]; then
      echo "Update available!"
      echo "Your Version..... = $lecho"
      echo "Server Version... = $recho"
      curl -sS -o /tmp/$name.zip https://kextupdater.slsoft.de/$name/$name.zip
      unzip -o /tmp/$name.zip -d ~/Desktop/Latest\ Kext\ Updater > /dev/null
      ln -sf /Applications ~/Desktop/Latest\ Kext\ Updater/Applications
      echo " "
      echo "Latest Version was downloaded to your Desktop into the Folder \"Latest Kext Updater\". Please replace your older Version with it! The Updater quits now."
      sleep 5
      open ~/Desktop/Latest\ Kext\ Updater/
      else
      echo "Update verfügbar!"
      echo "Installierte Version... = $lecho"
      echo "Server Version......... = $recho"
      curl -sS -o /tmp/$name.zip https://kextupdater.slsoft.de/$name/$name.zip
      unzip -o /tmp/$name.zip -d ~/Desktop/Aktueller\ Kext\ Updater > /dev/null
      ln -sf /Applications ~/Desktop/Aktueller\ Kext\ Updater/Applications
      echo " "
      echo "Die aktuelle Version wurde auf dem Schreibtisch im Ordner \"Aktueller Kext Updater\" abgelegt. Bitte ersetze deine derzeitige Version mit dieser. Der Kext Updater beendet sich jetzt."
      sleep 5
      open ~/Desktop/Aktueller\ Kext\ Updater/
      fi
    killall "Kext Updater"
    exit
    else
      if [[ $lan2 != "de_DE" ]]; then
      echo "√ You are up to date ($lecho)"
      else
      echo "√ Du bist auf dem neuesten Stand ($lecho)"
      fi
    echo "-----------------------------------------------------------"
    fi
fi

# ==== Ozmosis Warning ============== #
bin/BDMESG | grep "Ozmosis" > /dev/null
if [[ $? = "0" ]]; then
  if [[ $lan2 != "de_DE" ]]; then
  echo "Attention! Since you are using Ozmosis, please make sure that you don´t have any KEXTs twice in your System. One KEXT should not be stored in the ROM, the EFI Partition and S/L/E at the same time."
  else
  echo "Achtung! Solange du Ozmosis nutzt stelle bitte sicher, dass sich keine doppelten Kexte Im System befinden. Ein und der selbe Kext sollten nicht im ROM, der EFI Partition oder in S/L/E gleichzeitig installiert sein."
  fi
echo " "
fi